/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e){var t=e();typeof define=="function"&&define.amd&&define([],function(){return t})})(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../tools/Almond-0.2.9.min",function(){}),n("virtjs",[],function(){return window.Virtjs||window.require("virtjs")}),n("../../libraries/architectures/gb/./sources/components/./cpu/instructionSets",[],function(){var e,t,n;return{unprefixed:{ADC_r_n:{command:function(){var r=n[0][0];n[0][0]+=this.readUint8();var i=n[0][0];n[0][0]+=t.environment.cpuCarry;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=(i&15)<(r&15)||(s&15)<(i&15),t.environment.cpuCarry=i<r||s<i,2},debug:function(r){return{size:2,label:"adc "+[n[0].xRegister,e.FormatUtil.hexadecimal(t.mmu.readUint8(r),8)].join(", ")}}},ADC_r_r:{command:function(){var r=n[0][0];n[0][0]+=n[1][0];var i=n[0][0];n[0][0]+=t.environment.cpuCarry;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=(i&15)<(r&15)||(s&15)<(i&15),t.environment.cpuCarry=i<r||s<i,1},debug:function(e){return{size:1,label:"adc "+[n[0].xRegister,n[1].xRegister].join(", ")}}},ADC_r_rrm:{command:function(){var r=n[0][0];n[0][0]+=t.mmu.readUint8(n[1][0]);var i=n[0][0];n[0][0]+=t.environment.cpuCarry;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=(i&15)<(r&15)||(s&15)<(i&15),t.environment.cpuCarry=i<r||s<i,2},debug:function(e){return{size:1,label:"adc "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},ADD_r_n:{command:function(){var r=n[0][0];n[0][0]+=this.readUint8();var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)<(r&15),t.environment.cpuCarry=i<r,2},debug:function(r){return{size:2,label:"add "+[n[0].xRegister,e.FormatUtil.hexadecimal(t.mmu.readUint8(r),8)].join(", ")}}},ADD_r_r:{command:function(){var r=n[0][0];n[0][0]+=n[1][0];var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)<(r&15),t.environment.cpuCarry=i<r,1},debug:function(e){return{size:1,label:"add "+[n[0].xRegister,n[1].xRegister].join(", ")}}},ADD_r_rrm:{command:function(){var r=n[0][0];n[0][0]+=t.mmu.readUint8(n[1][0]);var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)<(r&15),t.environment.cpuCarry=i<r,2},debug:function(e){return{size:1,label:"add "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},ADD_rr_rr:{command:function(){var r=n[0][0];n[0][0]+=n[1][0];var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuHalf=(r&4095)>(i&4095),t.environment.cpuCarry=r>i,2},debug:function(e){return{size:1,label:"add "+[n[0].xRegister,n[1].xRegister].join(", ")}}},ADD_rr_sn:{command:function(){var r=n[0][0];n[0][0]+=this.readInt8();var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=(r&15)>(i&15),t.environment.cpuCarry=(r&255)>(i&255),4},debug:function(r){return{size:2,label:"add "+[n[0].xRegister,e.FormatUtil.decimal(t.mmu.readInt8(r))].join(", ")}}},AND_n:{command:function(){return t.environment.a[0]&=this.readUint8(),t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!0,t.environment.cpuCarry=!1,2},debug:function(n){return{size:2,label:"and "+[e.FormatUtil.hexadecimal(t.mmu.readUint8(n),8)].join(", ")}}},AND_r:{command:function(){return t.environment.a[0]&=n[0][0],t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!0,t.environment.cpuCarry=!1,1},debug:function(e){return{size:1,label:"and "+[n[0].xRegister].join(", ")}}},AND_rrm:{command:function(){return t.environment.a[0]&=t.mmu.readUint16(n[0][0]),t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!0,t.environment.cpuCarry=!1,2},debug:function(e){return{size:1,label:"and "+["("+n[0].xRegister+")"].join(", ")}}},CALL_C_nn:{command:function(){var n=this.readUint16();return t.environment.cpuCarry?(this.push(t.environment.pc[0]),t.environment.pc[0]=n,6):3},debug:function(n){return{size:3,label:"call c "+[e.FormatUtil.address(t.mmu.readUint16(n),16)].join(", ")}}},CALL_NC_nn:{command:function(){var n=this.readUint16();return t.environment.cpuCarry?3:(this.push(t.environment.pc[0]),t.environment.pc[0]=n,6)},debug:function(n){return{size:3,label:"call nc "+[e.FormatUtil.address(t.mmu.readUint16(n),16)].join(", ")}}},CALL_NZ_nn:{command:function(){var n=this.readUint16();return t.environment.cpuZero?3:(this.push(t.environment.pc[0]),t.environment.pc[0]=n,6)},debug:function(n){return{size:3,label:"call nz "+[e.FormatUtil.address(t.mmu.readUint16(n),16)].join(", ")}}},CALL_Z_nn:{command:function(){var n=this.readUint16();return t.environment.cpuZero?(this.push(t.environment.pc[0]),t.environment.pc[0]=n,6):3},debug:function(n){return{size:3,label:"call z "+[e.FormatUtil.address(t.mmu.readUint16(n),16)].join(", ")}}},CALL_nn:{command:function(){var n=this.readUint16();return this.push(t.environment.pc[0]),t.environment.pc[0]=n,6},debug:function(n){return{size:3,label:"call "+[e.FormatUtil.address(t.mmu.readUint16(n),16)].join(", ")}}},CCF:{command:function(){return t.environment.cpuBCD=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=!t.environment.cpuCarry,1},debug:function(e){return{size:1,label:"ccf"}}},CPL:{command:function(){return t.environment.a[0]=~t.environment.a[0],t.environment.cpuBCD=!0,t.environment.cpuHalf=!0,1},debug:function(e){return{size:1,label:"cpl"}}},CP_n:{command:function(){var n=t.environment.a[0],r=this.readUint8(),i=n-r&255;return t.environment.cpuBCD=!0,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)>(n&15),t.environment.cpuCarry=i>n,2},debug:function(n){return{size:2,label:"cp "+[e.FormatUtil.hexadecimal(t.mmu.readUint8(n),8)].join(", ")}}},CP_r:{command:function(){var r=t.environment.a[0],i=n[0][0],s=r-i&255;return t.environment.cpuBCD=!0,t.environment.cpuZero=s===0,t.environment.cpuHalf=(s&15)>(r&15),t.environment.cpuCarry=s>r,1},debug:function(e){return{size:1,label:"cp "+[n[0].xRegister].join(", ")}}},CP_rrm:{command:function(){var r=t.environment.a[0],i=t.mmu.readUint8(n[0][0]),s=r-i&255;return t.environment.cpuBCD=!0,t.environment.cpuZero=s===0,t.environment.cpuHalf=(s&15)>(r&15),t.environment.cpuCarry=s>r,2},debug:function(e){return{size:1,label:"cp "+["("+n[0].xRegister+")"].join(", ")}}},DAA:{command:function(){var n=0;return n|=t.environment.cpuHalf?6:0,n|=t.environment.cpuCarry?96:0,t.environment.cpuBCD?t.environment.a[0]-=n:(n|=(t.environment.a[0]&15)>9?6:0,n|=(t.environment.a[0]&255)>153?96:0,t.environment.a[0]+=n),t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(n&96)===96,1},debug:function(e){return{size:1,label:"daa"}}},DEC_r:{command:function(){var r=n[0][0];n[0][0]-=1;var i=n[0][0];return t.environment.cpuBCD=!0,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)===15,1},debug:function(e){return{size:1,label:"dec "+[n[0].xRegister].join(", ")}}},DEC_rr:{command:function(){return n[0][0]-=1,2},debug:function(e){return{size:1,label:"dec "+[n[0].xRegister].join(", ")}}},DEC_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r-1);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!0,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)===15,3},debug:function(e){return{size:1,label:"dec "+["("+n[0].xRegister+")"].join(", ")}}},DI:{command:function(){return t.environment.cpuInterruptFeature=!1,1},debug:function(e){return{size:1,label:"di"}}},EI:{command:function(){return t.environment.cpuInterruptFeature=!0,1},debug:function(e){return{size:1,label:"ei"}}},HALT:{command:function(){return t.environment.cpuHalt=!0,1},debug:function(e){return{size:1,label:"halt"}}},INC_r:{command:function(){var r=n[0][0];n[0][0]+=1;var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)===0,1},debug:function(e){return{size:1,label:"inc "+[n[0].xRegister].join(", ")}}},INC_rr:{command:function(){return n[0][0]+=1,2},debug:function(e){return{size:1,label:"inc "+[n[0].xRegister].join(", ")}}},INC_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r+1);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)===0,3},debug:function(e){return{size:1,label:"inc "+["("+n[0].xRegister+")"].join(", ")}}},JP_C_nn:{command:function(){var n=this.readUint16();return t.environment.cpuCarry?(t.environment.pc[0]=n,4):3},debug:function(n){return{size:3,label:"jp c "+[e.FormatUtil.hexadecimal(t.mmu.readUint16(n),16)].join(", ")}}},JP_NC_nn:{command:function(){var n=this.readUint16();return t.environment.cpuCarry?3:(t.environment.pc[0]=n,4)},debug:function(n){return{size:3,label:"jp nc "+[e.FormatUtil.hexadecimal(t.mmu.readUint16(n),16)].join(", ")}}},JP_NZ_nn:{command:function(){var n=this.readUint16();return t.environment.cpuZero?3:(t.environment.pc[0]=n,4)},debug:function(n){return{size:3,label:"jp nz "+[e.FormatUtil.hexadecimal(t.mmu.readUint16(n),16)].join(", ")}}},JP_Z_nn:{command:function(){var n=this.readUint16();return t.environment.cpuZero?(t.environment.pc[0]=n,4):3},debug:function(n){return{size:3,label:"jp z "+[e.FormatUtil.hexadecimal(t.mmu.readUint16(n),16)].join(", ")}}},JP_nn:{command:function(){var n=this.readUint16();return t.environment.pc[0]=n,4},debug:function(n){return{size:3,label:"jp "+[e.FormatUtil.hexadecimal(t.mmu.readUint16(n),16)].join(", ")}}},JP_rr:{command:function(){return t.environment.pc[0]=n[0][0],1},debug:function(e){return{size:1,label:"jp "+[n[0].xRegister].join(", ")}}},JR_C_sn:{command:function(){var n=this.readInt8();return t.environment.cpuCarry?(t.environment.pc[0]+=n,3):2},debug:function(n){return{size:2,label:"jr c "+[e.FormatUtil.address(n+t.mmu.readInt8(n)+1,16)].join(", ")}}},JR_NC_sn:{command:function(){var n=this.readInt8();return t.environment.cpuCarry?2:(t.environment.pc[0]+=n,3)},debug:function(n){return{size:2,label:"jr nc "+[e.FormatUtil.address(n+t.mmu.readInt8(n)+1,16)].join(", ")}}},JR_NZ_sn:{command:function(){var n=this.readInt8();return t.environment.cpuZero?2:(t.environment.pc[0]+=n,3)},debug:function(n){return{size:2,label:"jr nz "+[e.FormatUtil.address(n+t.mmu.readInt8(n)+1,16)].join(", ")}}},JR_Z_sn:{command:function(){var n=this.readInt8();return t.environment.cpuZero?(t.environment.pc[0]+=n,3):2},debug:function(n){return{size:2,label:"jr z "+[e.FormatUtil.address(n+t.mmu.readInt8(n)+1,16)].join(", ")}}},JR_sn:{command:function(){var n=this.readInt8();return t.environment.pc[0]+=n,3},debug:function(n){return{size:2,label:"jr "+[e.FormatUtil.address(n+t.mmu.readInt8(n)+1,16)].join(", ")}}},LDD_r_rrm:{command:function(){return n[0][0]=t.mmu.readUint8(n[1][0]),n[1][0]-=1,2},debug:function(e){return{size:1,label:"ldd "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},LDD_rrm_r:{command:function(){return t.mmu.writeUint8(n[0][0],n[1][0]),n[0][0]-=1,2},debug:function(e){return{size:1,label:"ldd "+["("+n[0].xRegister+")",n[1].xRegister].join(", ")}}},LDHL_rr_n:{command:function(){t.environment.hl[0]=n[0][0];var r=t.environment.hl[0];t.environment.hl[0]+=this.readInt8();var i=t.environment.hl[0];return t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=(r&15)>(i&15),t.environment.cpuCarry=(r&255)>(i&255),3},debug:function(r){return{size:2,label:"ldhl "+[n[0].xRegister,e.FormatUtil.decimal(t.mmu.readInt8(r))].join(", ")}}},LDH_nm_r:{command:function(){return t.mmu.writeUint8(65280+this.readUint8(),n[0][0]),3},debug:function(r){return{size:2,label:"ldh "+["("+e.FormatUtil.relativeAddress(65280,t.mmu.readUint8(r),16,8)+")",n[0].xRegister].join(", ")}}},LDH_r_nm:{command:function(){return n[0][0]=t.mmu.readUint8(65280+this.readUint8()),3},debug:function(r){return{size:2,label:"ldh "+[n[0].xRegister,"("+e.FormatUtil.relativeAddress(65280,t.mmu.readUint8(r),16,8)+")"].join(", ")}}},LDI_r_rrm:{command:function(){return n[0][0]=t.mmu.readUint8(n[1][0]),n[1][0]+=1,2},debug:function(e){return{size:1,label:"ldi "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},LDI_rrm_r:{command:function(){return t.mmu.writeUint8(n[0][0],n[1][0]),n[0][0]+=1,2},debug:function(e){return{size:1,label:"ldi "+["("+n[0].xRegister+")",n[1].xRegister].join(", ")}}},LD_nnm_r:{command:function(){return t.mmu.writeUint8(this.readUint16(),n[0][0]),4},debug:function(r){return{size:3,label:"ld "+[e.FormatUtil.address(t.mmu.readUint16(r),16),n[0].xRegister].join(", ")}}},LD_nnm_rr:{command:function(){return t.mmu.writeUint16(this.readUint16(),n[0][0]),5},debug:function(r){return{size:3,label:"ld "+[e.FormatUtil.address(t.mmu.readUint16(r),16),n[0].xRegister].join(", ")}}},LD_r_n:{command:function(){return n[0][0]=this.readUint8(),2},debug:function(r){return{size:2,label:"ld "+[n[0].xRegister,e.FormatUtil.hexadecimal(t.mmu.readUint8(r),8)].join(", ")}}},LD_r_nnm:{command:function(){return n[0][0]=t.mmu.readUint8(this.readUint16()),4},debug:function(r){return{size:3,label:"ld "+[n[0].xRegister,e.FormatUtil.address(t.mmu.readUint16(r),16)].join(", ")}}},LD_r_r:{command:function(){return n[0][0]=n[1][0],1},debug:function(e){return{size:1,label:"ld "+[n[0].xRegister,n[1].xRegister].join(", ")}}},LD_r_rm:{command:function(){return n[0][0]=t.mmu.readUint8(65280+n[1][0]),2},debug:function(t){return{size:1,label:"ld "+[n[0].xRegister,"("+e.FormatUtil.relativeAddress(65280,n[1].xRegister,16,8)+")"].join(", ")}}},LD_r_rrm:{command:function(){return n[0][0]=t.mmu.readUint8(n[1][0]),2},debug:function(e){return{size:1,label:"ld "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},LD_rm_r:{command:function(){return t.mmu.writeUint8(65280+n[0][0],n[1][0]),2},debug:function(t){return{size:1,label:"ld "+["("+e.FormatUtil.relativeAddress(65280,n[0].xRegister,16,8)+")",n[1].xRegister].join(", ")}}},LD_rr_nn:{command:function(){return n[0][0]=this.readUint16(),3},debug:function(r){return{size:3,label:"ld "+[n[0].xRegister,e.FormatUtil.hexadecimal(t.mmu.readUint16(r),16)].join(", ")}}},LD_rr_rr:{command:function(){return n[0][0]=n[1][0],2},debug:function(e){return{size:1,label:"ld "+[n[0].xRegister,n[1].xRegister].join(", ")}}},LD_rrm_n:{command:function(){return t.mmu.writeUint8(n[0][0],this.readUint8()),3},debug:function(r){return{size:2,label:"ld "+["("+n[0].xRegister+")",e.FormatUtil.hexadecimal(t.mmu.readUint8(r),8)].join(", ")}}},LD_rrm_r:{command:function(){return t.mmu.writeUint8(n[0][0],n[1][0]),2},debug:function(e){return{size:1,label:"ld "+["("+n[0].xRegister+")",n[1].xRegister].join(", ")}}},NOP:{command:function(){return 1},debug:function(e){return{size:1,label:"nop"}}},OR_n:{command:function(){return t.environment.a[0]|=t.mmu.readUint8(t.environment.pc[0]),t.environment.pc[0]+=1,t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,2},debug:function(n){return{size:2,label:"or "+[e.FormatUtil.hexadecimal(t.mmu.readUint8(n),8)].join(", ")}}},OR_r:{command:function(){return t.environment.a[0]|=n[0][0],t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,1},debug:function(e){return{size:1,label:"or "+[n[0].xRegister].join(", ")}}},OR_rrm:{command:function(){return t.environment.a[0]|=t.mmu.readUint8(n[0][0]),t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,2},debug:function(e){return{size:1,label:"or "+["("+n[0].xRegister+")"].join(", ")}}},POP_rr:{command:function(){return n[0][0]=this.pop(),3},debug:function(e){return{size:1,label:"pop "+[n[0].xRegister].join(", ")}}},POP_AF:{command:function(){return t.environment.af[0]=this.pop(),3},debug:function(e){return{size:1,label:"pop af"}}},PREFIX_CB:{command:function(){var t=this.readUint8();return this._opcodeMaps.cbprefixed[t]()},debug:function(e){var n=t.mmu.readUint8(e),r=this._opcodeMaps.cbprefixed[n];return{size:2,label:r.xDefinition.debug.call(this,e+1).label}}},PUSH_rr:{command:function(){return this.push(n[0][0]),4},debug:function(e){return{size:1,label:"push "+[n[0].xRegister].join(", ")}}},RET:{command:function(){return t.environment.pc[0]=this.pop(),4},debug:function(e){return{size:1,label:"ret"}}},RETI:{command:function(){return t.environment.pc[0]=this.pop(),t.environment.cpuInterruptFeature=!0,4},debug:function(e){return{size:1,label:"reti"}}},RET_NC:{command:function(){return t.environment.cpuCarry?2:(t.environment.pc[0]=this.pop(),5)},debug:function(e){return{size:1,label:"ret nc"}}},RET_NZ:{command:function(){return t.environment.cpuZero?2:(t.environment.pc[0]=this.pop(),5)},debug:function(e){return{size:1,label:"ret nz"}}},RET_Z:{command:function(){return t.environment.cpuZero?(t.environment.pc[0]=this.pop(),5):2},debug:function(e){return{size:1,label:"ret z"}}},RET_C:{command:function(){return t.environment.cpuCarry?(t.environment.pc[0]=this.pop(),5):2},debug:function(e){return{size:1,label:"ret c"}}},RLA:{command:function(){var n=t.environment.cpuCarry?1:0,r=t.environment.a[0]&128?1:0;return t.environment.a[0]<<=1,t.environment.a[0]|=n<<0,t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=r===1,1},debug:function(e){return{size:1,label:"rla"}}},RLCA:{command:function(){var n=t.environment.a[0]&128?1:0;return t.environment.a[0]<<=1,t.environment.a[0]|=n<<0,t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=n===1,1},debug:function(e){return{size:1,label:"rlca"}}},RRA:{command:function(){var n=t.environment.cpuCarry?1:0,r=t.environment.a[0]&1?1:0;return t.environment.a[0]>>=1,t.environment.a[0]|=n<<7,t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=r===1,1},debug:function(e){return{size:1,label:"rra"}}},RRCA:{command:function(){var n=t.environment.a[0]&1?1:0;return t.environment.a[0]>>=1,t.environment.a[0]|=n<<7,t.environment.cpuBCD=!1,t.environment.cpuZero=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=n===1,1},debug:function(e){return{size:1,label:"rrca"}}},RST_n:{command:function(){return this.push(t.environment.pc[0]),t.environment.pc[0]=n[0],4},debug:function(t){return{size:1,label:"rst "+[e.FormatUtil.hexadecimal(n[0],8)].join(", ")}}},SBC_r_n:{command:function(){var r=t.environment.cpuCarry?1:0,i=n[0][0];n[0][0]-=this.readUint8();var s=n[0][0];n[0][0]-=r;var o=n[0][0];return t.environment.cpuBCD=!0,t.environment.cpuZero=o===0,t.environment.cpuHalf=(s&15)>(i&15)||(o&15)>(s&15),t.environment.cpuCarry=s>i||o>s,2},debug:function(r){return{size:2,label:"sbc "+[n[0].xRegister,e.FormatUtil.hexadecimal(t.mmu.readUint8(r),8)].join(", ")}}},SBC_r_r:{command:function(){var r=t.environment.cpuCarry?1:0,i=n[0][0];n[0][0]-=n[1][0];var s=n[0][0];n[0][0]-=r;var o=n[0][0];return t.environment.cpuBCD=!0,t.environment.cpuZero=o===0,t.environment.cpuHalf=(s&15)>(i&15)||(o&15)>(s&15),t.environment.cpuCarry=s>i||o>s,1},debug:function(e){return{size:1,label:"sbc "+[n[0].xRegister,n[1].xRegister].join(", ")}}},SBC_r_rrm:{command:function(){var r=t.environment.cpuCarry?1:0,i=n[0][0];n[0][0]-=t.mmu.readUint8(n[1][0]);var s=n[0][0];n[0][0]-=r;var o=n[0][0];return t.environment.cpuBCD=!0,t.environment.cpuZero=o===0,t.environment.cpuHalf=(s&15)>(i&15)||(o&15)>(s&15),t.environment.cpuCarry=s>i||o>s,2},debug:function(e){return{size:1,label:"sbc "+[n[0].xRegister,"("+n[1].xRegister+")"].join(", ")}}},SCF:{command:function(){return t.environment.cpuBCD=!1,t.environment.cpuHalf=!1,t.environment.cpuCarry=!0,1},debug:function(e){return{size:1,label:"scf"}}},STOP_0:{command:function(){return t.environment.pc[0]+=1,1},debug:function(e){return{size:2,label:"stop 0"}}},SUB_n:{command:function(){var n=t.environment.a[0];t.environment.a[0]-=this.readUint8();var r=t.environment.a[0];return t.environment.cpuBCD=!0,t.environment.cpuZero=r===0,t.environment.cpuHalf=(r&15)>(n&15),t.environment.cpuCarry=r>n,2},debug:function(n){return{size:2,label:"sub "+[e.FormatUtil.hexadecimal(t.mmu.readUint8(n),8)].join(", ")}}},SUB_r:{command:function(){var r=t.environment.a[0];t.environment.a[0]-=n[0][0];var i=t.environment.a[0];return t.environment.cpuBCD=!0,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)>(r&15),t.environment.cpuCarry=i>r,1},debug:function(e){return{size:1,label:"sub "+[n[0].xRegister].join(", ")}}},SUB_rrm:{command:function(){var r=t.environment.a[0];t.environment.a[0]-=t.mmu.readUint8(n[0][0]);var i=t.environment.a[0];return t.environment.cpuBCD=!0,t.environment.cpuZero=i===0,t.environment.cpuHalf=(i&15)>(r&15),t.environment.cpuCarry=i>r,2},debug:function(e){return{size:1,label:"sub "+["("+n[0].xRegister+")"].join(", ")}}},XOR_n:{command:function(){return t.environment.a[0]^=this.readUint8(),t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,2},debug:function(n){return{size:2,label:"xor "+[e.FormatUtil.hexadecimal(t.mmu.readUint8(n),8)].join(", ")}}},XOR_r:{command:function(){return t.environment.a[0]^=n[0][0],t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,1},debug:function(e){return{size:1,label:"xor "+[n[0].xRegister].join(", ")}}},XOR_rrm:{command:function(){return t.environment.a[0]^=t.mmu.readUint8(n[0][0]),t.environment.cpuBCD=!1,t.environment.cpuZero=t.environment.a[0]===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,2},debug:function(e){return{size:1,label:"xor "+["("+n[0].xRegister+")"].join(", ")}}}},cbprefixed:{BIT_n_r:{command:function(){var r=(n[1][0]&1<<n[0])===0;return t.environment.cpuBCD=!1,t.environment.cpuZero=r,t.environment.cpuHalf=!0,2},debug:function(e){return{size:2,label:"bit "+[n[0],n[1].xRegister].join(", ")}}},BIT_n_rrm:{command:function(){var r=t.mmu.readUint8(n[1][0]),i=(r&1<<n[0])===0;return t.environment.cpuBCD=!1,t.environment.cpuZero=i,t.environment.cpuHalf=!0,3},debug:function(e){return{size:2,label:"bit "+[n[0],"("+n[1].xRegister+")"].join(", ")}}},RES_n_r:{command:function(){return n[1][0]&=~(1<<n[0]),2},debug:function(e){return{size:2,label:"res "+[n[0],n[1].xRegister].join(", ")}}},RES_n_rrm:{command:function(){var r=t.mmu.readUint8(n[1][0])&~(1<<n[0]);return t.mmu.writeUint8(n[1][0],r),4},debug:function(e){return{size:2,label:"res "+[n[0],"("+n[1].xRegister+")"].join(", ")}}},RLC_r:{command:function(){var r=n[0][0],i=r&128?1:0;n[0][0]=r<<1|i<<0;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=i===1,2},debug:function(e){return{size:2,label:"rlc "+[n[0].xRegister].join(", ")}}},RLC_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]),i=r&128?1:0;t.mmu.writeUint8(n[0][0],r<<1|i<<0);var s=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=i===1,4},debug:function(e){return{size:2,label:"rlc "+["("+n[0].xRegister+")"].join(", ")}}},RL_r:{command:function(){var r=t.environment.cpuCarry?1:0,i=n[0][0];n[0][0]=i<<1|r<<0;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(i&128)===128,2},debug:function(e){return{size:2,label:"rl "+[n[0].xRegister].join(", ")}}},RL_rrm:{command:function(){var r=t.environment.cpuCarry?1:0,i=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],i<<1|r<<0);var s=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(i&128)===128,4},debug:function(e){return{size:2,label:"rl "+["("+n[0].xRegister+")"].join(", ")}}},RRC_r:{command:function(){var r=n[0][0],i=r&1?1:0;n[0][0]=r>>1|i<<7;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=i===1,2},debug:function(e){return{size:2,label:"rrc "+[n[0].xRegister].join(", ")}}},RRC_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]),i=r&1?1:0;t.mmu.writeUint8(n[0][0],r>>1|i<<7);var s=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=i===1,4},debug:function(e){return{size:2,label:"rrc "+["("+n[0].xRegister+")"].join(", ")}}},RR_r:{command:function(){var r=t.environment.cpuCarry?1:0,i=n[0][0];n[0][0]=r<<7|i>>1;var s=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(i&1)===1,2},debug:function(e){return{size:2,label:"rr "+[n[0].xRegister].join(", ")}}},RR_rrm:{command:function(){var r=t.environment.cpuCarry?1:0,i=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r<<7|i>>1);var s=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=s===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(i&1)===1,4},debug:function(e){return{size:2,label:"rr "+["("+n[0].xRegister+")"].join(", ")}}},SET_n_r:{command:function(){return n[1][0]|=1<<n[0],2},debug:function(e){return{size:2,label:"set "+[n[0],n[1].xRegister].join(", ")}}},SET_n_rrm:{command:function(){var r=t.mmu.readUint8(n[1][0])|1<<n[0];return t.mmu.writeUint8(n[1][0],r),4},debug:function(e){return{size:2,label:"set "+[n[0],"("+n[1].xRegister+")"].join(", ")}}},SLA_r:{command:function(){var r=n[0][0];n[0][0]<<=1;var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&128)===128,2},debug:function(e){return{size:2,label:"sla "+[n[0].xRegister].join(", ")}}},SLA_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r<<1);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&128)===128,4},debug:function(e){return{size:2,label:"sla "+["("+n[0].xRegister+")"].join(", ")}}},SRA_r:{command:function(){var r=n[0][0];n[0][0]=r>>1|r&128;var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&1)===1,2},debug:function(e){return{size:2,label:"sra "+[n[0].xRegister].join(", ")}}},SRA_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r>>1|r&128);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&1)===1,4},debug:function(e){return{size:2,label:"sra "+["("+n[0].xRegister+")"].join(", ")}}},SRL_r:{command:function(){var r=n[0][0];n[0][0]>>=1;var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&1)===1,2},debug:function(e){return{size:2,label:"srl "+[n[0].xRegister].join(", ")}}},SRL_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r>>1);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=(r&1)===1,4},debug:function(e){return{size:2,label:"srl "+["("+n[0].xRegister+")"].join(", ")}}},SWAP_r:{command:function(){var r=n[0][0];n[0][0]=r<<4|r>>4;var i=n[0][0];return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,2},debug:function(e){return{size:2,label:"swap "+[n[0].xRegister].join(", ")}}},SWAP_rrm:{command:function(){var r=t.mmu.readUint8(n[0][0]);t.mmu.writeUint8(n[0][0],r<<4|r>>4);var i=t.mmu.readUint8(n[0][0]);return t.environment.cpuBCD=!1,t.environment.cpuZero=i===0,t.environment.cpuHalf=!1,t.environment.cpuCarry=!1,4},debug:function(e){return{size:2,label:"swap "+["("+n[0].xRegister+")"].join(", ")}}}},interruptions:{RST_n:{command:function(){return this.push(t.environment.pc[0]),t.environment.pc[0]=n[0],4},debug:function(t){return{size:1,label:"rst "+[e.FormatUtil.hexadecimal(n[0],8)].join(", ")}}}}}}),n("../../libraries/architectures/gb/./sources/components/../tables/opcodeMaps",[],function(){return{interruptions:["RST_n:0x40","RST_n:0x48","RST_n:0x50","RST_n:0x60",null],unprefixed:["NOP","LD_rr:bc_nn","LD_rrm:bc_r:a","INC_rr:bc","INC_r:b","DEC_r:b","LD_r:b_n","RLCA","LD_nnm_rr:sp","ADD_rr:hl_rr:bc","LD_r:a_rrm:bc","DEC_rr:bc","INC_r:c","DEC_r:c","LD_r:c_n","RRCA","STOP_0","LD_rr:de_nn","LD_rrm:de_r:a","INC_rr:de","INC_r:d","DEC_r:d","LD_r:d_n","RLA","JR_sn","ADD_rr:hl_rr:de","LD_r:a_rrm:de","DEC_rr:de","INC_r:e","DEC_r:e","LD_r:e_n","RRA","JR_NZ_sn","LD_rr:hl_nn","LDI_rrm:hl_r:a","INC_rr:hl","INC_r:h","DEC_r:h","LD_r:h_n","DAA","JR_Z_sn","ADD_rr:hl_rr:hl","LDI_r:a_rrm:hl","DEC_rr:hl","INC_r:l","DEC_r:l","LD_r:l_n","CPL","JR_NC_sn","LD_rr:sp_nn","LDD_rrm:hl_r:a","INC_rr:sp","INC_rrm:hl","DEC_rrm:hl","LD_rrm:hl_n","SCF","JR_C_sn","ADD_rr:hl_rr:sp","LDD_r:a_rrm:hl","DEC_rr:sp","INC_r:a","DEC_r:a","LD_r:a_n","CCF","LD_r:b_r:b","LD_r:b_r:c","LD_r:b_r:d","LD_r:b_r:e","LD_r:b_r:h","LD_r:b_r:l","LD_r:b_rrm:hl","LD_r:b_r:a","LD_r:c_r:b","LD_r:c_r:c","LD_r:c_r:d","LD_r:c_r:e","LD_r:c_r:h","LD_r:c_r:l","LD_r:c_rrm:hl","LD_r:c_r:a","LD_r:d_r:b","LD_r:d_r:c","LD_r:d_r:d","LD_r:d_r:e","LD_r:d_r:h","LD_r:d_r:l","LD_r:d_rrm:hl","LD_r:d_r:a","LD_r:e_r:b","LD_r:e_r:c","LD_r:e_r:d","LD_r:e_r:e","LD_r:e_r:h","LD_r:e_r:l","LD_r:e_rrm:hl","LD_r:e_r:a","LD_r:h_r:b","LD_r:h_r:c","LD_r:h_r:d","LD_r:h_r:e","LD_r:h_r:h","LD_r:h_r:l","LD_r:h_rrm:hl","LD_r:h_r:a","LD_r:l_r:b","LD_r:l_r:c","LD_r:l_r:d","LD_r:l_r:e","LD_r:l_r:h","LD_r:l_r:l","LD_r:l_rrm:hl","LD_r:l_r:a","LD_rrm:hl_r:b","LD_rrm:hl_r:c","LD_rrm:hl_r:d","LD_rrm:hl_r:e","LD_rrm:hl_r:h","LD_rrm:hl_r:l","HALT","LD_rrm:hl_r:a","LD_r:a_r:b","LD_r:a_r:c","LD_r:a_r:d","LD_r:a_r:e","LD_r:a_r:h","LD_r:a_r:l","LD_r:a_rrm:hl","LD_r:a_r:a","ADD_r:a_r:b","ADD_r:a_r:c","ADD_r:a_r:d","ADD_r:a_r:e","ADD_r:a_r:h","ADD_r:a_r:l","ADD_r:a_rrm:hl","ADD_r:a_r:a","ADC_r:a_r:b","ADC_r:a_r:c","ADC_r:a_r:d","ADC_r:a_r:e","ADC_r:a_r:h","ADC_r:a_r:l","ADC_r:a_rrm:hl","ADC_r:a_r:a","SUB_r:b","SUB_r:c","SUB_r:d","SUB_r:e","SUB_r:h","SUB_r:l","SUB_rrm:hl","SUB_r:a","SBC_r:a_r:b","SBC_r:a_r:c","SBC_r:a_r:d","SBC_r:a_r:e","SBC_r:a_r:h","SBC_r:a_r:l","SBC_r:a_rrm:hl","SBC_r:a_r:a","AND_r:b","AND_r:c","AND_r:d","AND_r:e","AND_r:h","AND_r:l","AND_rrm:hl","AND_r:a","XOR_r:b","XOR_r:c","XOR_r:d","XOR_r:e","XOR_r:h","XOR_r:l","XOR_rrm:hl","XOR_r:a","OR_r:b","OR_r:c","OR_r:d","OR_r:e","OR_r:h","OR_r:l","OR_rrm:hl","OR_r:a","CP_r:b","CP_r:c","CP_r:d","CP_r:e","CP_r:h","CP_r:l","CP_rrm:hl","CP_r:a","RET_NZ","POP_rr:bc","JP_NZ_nn","JP_nn","CALL_NZ_nn","PUSH_rr:bc","ADD_r:a_n","RST_n:0x00","RET_Z","RET","JP_Z_nn","PREFIX_CB","CALL_Z_nn","CALL_nn","ADC_r:a_n","RST_n:0x08","RET_NC","POP_rr:de","JP_NC_nn",null,"CALL_NC_nn","PUSH_rr:de","SUB_n","RST_n:0x10","RET_C","RETI","JP_C_nn",null,"CALL_C_nn",null,"SBC_r:a_n","RST_n:0x18","LDH_nm_r:a","POP_rr:hl","LD_rm:c_r:a",null,null,"PUSH_rr:hl","AND_n","RST_n:0x20","ADD_rr:sp_sn","JP_rr:hl","LD_nnm_r:a",null,null,null,"XOR_n","RST_n:0x28","LDH_r:a_nm","POP_AF","LD_r:a_rm:c","DI",null,"PUSH_rr:af","OR_n","RST_n:0x30","LDHL_rr:sp_n","LD_rr:sp_rr:hl","LD_r:a_nnm","EI",null,null,"CP_n","RST_n:0x38"],cbprefixed:["RLC_r:b","RLC_r:c","RLC_r:d","RLC_r:e","RLC_r:h","RLC_r:l","RLC_rrm:hl","RLC_r:a","RRC_r:b","RRC_r:c","RRC_r:d","RRC_r:e","RRC_r:h","RRC_r:l","RRC_rrm:hl","RRC_r:a","RL_r:b","RL_r:c","RL_r:d","RL_r:e","RL_r:h","RL_r:l","RL_rrm:hl","RL_r:a","RR_r:b","RR_r:c","RR_r:d","RR_r:e","RR_r:h","RR_r:l","RR_rrm:hl","RR_r:a","SLA_r:b","SLA_r:c","SLA_r:d","SLA_r:e","SLA_r:h","SLA_r:l","SLA_rrm:hl","SLA_r:a","SRA_r:b","SRA_r:c","SRA_r:d","SRA_r:e","SRA_r:h","SRA_r:l","SRA_rrm:hl","SRA_r:a","SWAP_r:b","SWAP_r:c","SWAP_r:d","SWAP_r:e","SWAP_r:h","SWAP_r:l","SWAP_rrm:hl","SWAP_r:a","SRL_r:b","SRL_r:c","SRL_r:d","SRL_r:e","SRL_r:h","SRL_r:l","SRL_rrm:hl","SRL_r:a","BIT_n:0_r:b","BIT_n:0_r:c","BIT_n:0_r:d","BIT_n:0_r:e","BIT_n:0_r:h","BIT_n:0_r:l","BIT_n:0_rrm:hl","BIT_n:0_r:a","BIT_n:1_r:b","BIT_n:1_r:c","BIT_n:1_r:d","BIT_n:1_r:e","BIT_n:1_r:h","BIT_n:1_r:l","BIT_n:1_rrm:hl","BIT_n:1_r:a","BIT_n:2_r:b","BIT_n:2_r:c","BIT_n:2_r:d","BIT_n:2_r:e","BIT_n:2_r:h","BIT_n:2_r:l","BIT_n:2_rrm:hl","BIT_n:2_r:a","BIT_n:3_r:b","BIT_n:3_r:c","BIT_n:3_r:d","BIT_n:3_r:e","BIT_n:3_r:h","BIT_n:3_r:l","BIT_n:3_rrm:hl","BIT_n:3_r:a","BIT_n:4_r:b","BIT_n:4_r:c","BIT_n:4_r:d","BIT_n:4_r:e","BIT_n:4_r:h","BIT_n:4_r:l","BIT_n:4_rrm:hl","BIT_n:4_r:a","BIT_n:5_r:b","BIT_n:5_r:c","BIT_n:5_r:d","BIT_n:5_r:e","BIT_n:5_r:h","BIT_n:5_r:l","BIT_n:5_rrm:hl","BIT_n:5_r:a","BIT_n:6_r:b","BIT_n:6_r:c","BIT_n:6_r:d","BIT_n:6_r:e","BIT_n:6_r:h","BIT_n:6_r:l","BIT_n:6_rrm:hl","BIT_n:6_r:a","BIT_n:7_r:b","BIT_n:7_r:c","BIT_n:7_r:d","BIT_n:7_r:e","BIT_n:7_r:h","BIT_n:7_r:l","BIT_n:7_rrm:hl","BIT_n:7_r:a","RES_n:0_r:b","RES_n:0_r:c","RES_n:0_r:d","RES_n:0_r:e","RES_n:0_r:h","RES_n:0_r:l","RES_n:0_rrm:hl","RES_n:0_r:a","RES_n:1_r:b","RES_n:1_r:c","RES_n:1_r:d","RES_n:1_r:e","RES_n:1_r:h","RES_n:1_r:l","RES_n:1_rrm:hl","RES_n:1_r:a","RES_n:2_r:b","RES_n:2_r:c","RES_n:2_r:d","RES_n:2_r:e","RES_n:2_r:h","RES_n:2_r:l","RES_n:2_rrm:hl","RES_n:2_r:a","RES_n:3_r:b","RES_n:3_r:c","RES_n:3_r:d","RES_n:3_r:e","RES_n:3_r:h","RES_n:3_r:l","RES_n:3_rrm:hl","RES_n:3_r:a","RES_n:4_r:b","RES_n:4_r:c","RES_n:4_r:d","RES_n:4_r:e","RES_n:4_r:h","RES_n:4_r:l","RES_n:4_rrm:hl","RES_n:4_r:a","RES_n:5_r:b","RES_n:5_r:c","RES_n:5_r:d","RES_n:5_r:e","RES_n:5_r:h","RES_n:5_r:l","RES_n:5_rrm:hl","RES_n:5_r:a","RES_n:6_r:b","RES_n:6_r:c","RES_n:6_r:d","RES_n:6_r:e","RES_n:6_r:h","RES_n:6_r:l","RES_n:6_rrm:hl","RES_n:6_r:a","RES_n:7_r:b","RES_n:7_r:c","RES_n:7_r:d","RES_n:7_r:e","RES_n:7_r:h","RES_n:7_r:l","RES_n:7_rrm:hl","RES_n:7_r:a","SET_n:0_r:b","SET_n:0_r:c","SET_n:0_r:d","SET_n:0_r:e","SET_n:0_r:h","SET_n:0_r:l","SET_n:0_rrm:hl","SET_n:0_r:a","SET_n:1_r:b","SET_n:1_r:c","SET_n:1_r:d","SET_n:1_r:e","SET_n:1_r:h","SET_n:1_r:l","SET_n:1_rrm:hl","SET_n:1_r:a","SET_n:2_r:b","SET_n:2_r:c","SET_n:2_r:d","SET_n:2_r:e","SET_n:2_r:h","SET_n:2_r:l","SET_n:2_rrm:hl","SET_n:2_r:a","SET_n:3_r:b","SET_n:3_r:c","SET_n:3_r:d","SET_n:3_r:e","SET_n:3_r:h","SET_n:3_r:l","SET_n:3_rrm:hl","SET_n:3_r:a","SET_n:4_r:b","SET_n:4_r:c","SET_n:4_r:d","SET_n:4_r:e","SET_n:4_r:h","SET_n:4_r:l","SET_n:4_rrm:hl","SET_n:4_r:a","SET_n:5_r:b","SET_n:5_r:c","SET_n:5_r:d","SET_n:5_r:e","SET_n:5_r:h","SET_n:5_r:l","SET_n:5_rrm:hl","SET_n:5_r:a","SET_n:6_r:b","SET_n:6_r:c","SET_n:6_r:d","SET_n:6_r:e","SET_n:6_r:h","SET_n:6_r:l","SET_n:6_rrm:hl","SET_n:6_r:a","SET_n:7_r:b","SET_n:7_r:c","SET_n:7_r:d","SET_n:7_r:e","SET_n:7_r:h","SET_n:7_r:l","SET_n:7_rrm:hl","SET_n:7_r:a"]}}),n("../../libraries/architectures/gb/./sources/components/CPU",["virtjs","./cpu/instructionSets","../tables/opcodeMaps"],function(e,t,n){return e.ClassUtil.extend([e.EmitterMixin],{initialize:function(t){this._engine=t,e.DebugUtil.preprocessFunction(this,"step",this._engine._options)},setup:function(){this._instructionSets={},this._opcodeMaps={},Object.keys(n).forEach(function(r){var i=this._instructionSets[r]={},s=this._opcodeMaps[r]=[];n[r].forEach(function(n,o){if(!n)return;var u=n.replace(/:[^_]*/g,""),a=t[r][u],f={Virtjs:e,engine:this._engine,parameters:n.split(/_/).filter(function(e){return e.indexOf(":")!==-1}).map(function(e){return e.split(":")}).map(function(e){return e[0]==="n"?parseInt(e[1]):this._engine.environment[e[1]]}.bind(this))},l=Object.keys(a).reduce(function(t,n){return e.ReflectionUtil.resetScope(t,n,a[n],f),t[n]=e.FunctionUtil.fastBind(t[n],this),t}.bind(this),{});i[n]=l,s[o]=l.command,l.command.xDefinition=l}.bind(this))}.bind(this))},step:function(){if(this._engine.environment.cpuStop)this._engine._continue=!1;else if(this._engine.environment.cpuHalt){var t=this._calculateHaltPeriod(),t=1;this._engine.gpu.step(t),this._engine.timer.step(t)}else{var n=this._engine.environment.pc[0],r=this._engine.mmu.readUint8(n),i=this._opcodeMaps.unprefixed[r];if(typeof preprocess!="undefined"&&(preprocess.events||[]).indexOf("instruction")!==-1){var s=!1,o=function(){s=!0};this.emit("instruction",{address:n,opcode:r,instruction:i,"break":o});if(s){this._engine.pause();return}}this._engine.environment.pc[0]+=1;var t=i();this._engine.gpu.step(t),this._engine.timer.step(t)}var u=this._engine.environment.enabledInterrupts,a=this._engine.environment.pendingInterrupts,f=a&u;if(!f)return;this._engine.environment.cpuStop=!1,this._engine.environment.cpuHalt=!1;if(!this._engine.environment.cpuInterruptFeature)return;this._engine.environment.cpuInterruptFeature=!1;for(var l=0;l<5;++l){var c=1<<l;if(f&c)break}this._engine.environment.pendingInterrupts-=c;var h=this._opcodeMaps.interruptions[l].call(this);this._engine.gpu.step(t),this._engine.timer.step(t)},readUint8:function(){var e=this._engine.mmu.readUint8(this._engine.environment.pc[0]);return this._engine.environment.pc[0]+=1,e},readInt8:function(){var e=this._engine.mmu.readInt8(this._engine.environment.pc[0]);return this._engine.environment.pc[0]+=1,e},readUint16:function(){var e=this._engine.mmu.readUint16(this._engine.environment.pc[0]);return this._engine.environment.pc[0]+=2,e},push:function(e){this._engine.environment.sp[0]-=2,this._engine.mmu.writeUint16(this._engine.environment.sp[0],e)},pop:function(){var e=this._engine.mmu.readUint16(this._engine.environment.sp[0],e);return this._engine.environment.sp[0]+=2,e},_calculateHaltPeriod:function(){return}})}),n("../../libraries/architectures/gb/./sources/components/./gpu/StateMachine",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e},setup:function(){},step:function(e){this._engine.environment.gpuClock+=e,this._engine.environment.gpuFrameClock+=e;switch(this._engine.environment.gpuMode){case 0:this._hblank();break;case 1:this._vblank();break;case 2:this._oam();break;case 3:this._vram()}},reclock:function(e){this._engine.environment.gpuFrameClock+=e,this._engine.environment.gpuLine=Math.floor(this._engine.environment.gpuFrameClock/114);if(this._engine.environment.gpuFrameClock>=16416)this._setMode(1),this._engine.environment.gpuClock=this._engine.environment.gpuFrameClock-16416;else{var t=this._engine.environment.gpuFrameClock%114;(t-=20)<0?(this._setMode(2),this._engine.environment.gpuClock=20+t):(t-=43)<0?(this._setMode(3),this._engine.environment.gpuClock=43+t):(t-=51)<0&&(this._setMode(0),this._engine.environment.gpuClock=51+t)}},_setMode:function(e){this._engine.environment.gpuMode=e,e===0?this._engine.gpu._hblank(this._engine.environment.gpuLine):e===1&&this._engine.gpu._vblank(),e!==3&&this._engine.environment.gpuInterrupts&1<<3+e&&(this._engine.environment.pendingInterrupts|=2)},_hblank:function(){if(this._engine.environment.gpuClock<51)return;this._engine.environment.gpuClock=0,this._engine.environment.gpuLine+=1,this._engine.environment.gpuCoincidence=this._engine.environment.gpuLine===this._engine.environment.gpuLyCompare,this._engine.environment.gpuCoincidence&&this._engine.environment.gpuInterrupts&64&&(this._engine.environment.pendingInterrupts|=2),this._engine.environment.gpuLine<144?this._setMode(2):this._setMode(1)},_vblank:function(){if(this._engine.environment.gpuClock<114)return;this._engine.environment.gpuClock=0,this._engine.environment.gpuLine+=1,this._engine.environment.gpuLine===154&&(this._engine.environment.gpuLine=0),this._engine.environment.gpuCoincidence=this._engine.environment.gpuLine===this._engine.environment.gpuLyCompare,this._engine.environment.gpuCoincidence&&this._engine.environment.gpuInterrupts&64&&(this._engine.environment.pendingInterrupts|=2);if(this._engine.environment.gpuLine!==0)return;this._engine.environment.gpuFrameClock=0,this._setMode(2)},_oam:function(){if(this._engine.environment.gpuClock<20)return;this._engine.environment.gpuClock=0,this._setMode(3)},_vram:function(){if(this._engine.environment.gpuClock<43)return;this._engine.environment.gpuClock=0,this._setMode(0)}})}),n("../../libraries/architectures/gb/./sources/components/GPU",["virtjs","./gpu/StateMachine"],function(e,t){var n={0:255,1:192,2:96,3:0};return e.ClassUtil.extend({initialize:function(e){this._engine=e,this._states=new t(e),this._scanline=new Uint16Array(160)},setup:function(){this._sprites=[];for(var e=0;e<40;++e)this._sprites[e]={};for(var e=0;e<160;++e)this._updateSprite(e);this._states.setup()},step:function(e){this._states.step(e)},reclock:function(e){this._states.reclock(e),this._states.step(0)},settingsMapping:function(t){return t===0?e.MemoryUtil.accessor(this._settingsAccess,this):t===1?e.MemoryUtil.accessor(this._lcdStatusAccess,this):t===2?e.MemoryUtil.accessor(this._scrollAccess,this,1):t===3?e.MemoryUtil.accessor(this._scrollAccess,this,0):t===4?e.MemoryUtil.accessor(this._lineAccess,this):t===5?e.MemoryUtil.accessor(this._lycAccess,this):t===6?e.MemoryUtil.accessor(this._oamDmaAccess,this):t===7?e.MemoryUtil.accessor(this._paletteAccess,this,0):t===8?e.MemoryUtil.accessor(this._paletteAccess,this,1):t===9?e.MemoryUtil.accessor(this._paletteAccess,this,2):t===10?e.MemoryUtil.accessor(this._windowPositionAccess,this,1):t===11?e.MemoryUtil.accessor(this._windowPositionAccess,this,0):t===13?e.MemoryUtil.immutable(0):t===15?e.MemoryUtil.immutable(0):t>=40&&t<=43?e.MemoryUtil.immutable(0):e.MemoryUtil.unaddressable(t,16)},oamMapping:function(t){return e.MemoryUtil.accessor(this._oamAccess,this,t)},vramMapping:function(t){return e.MemoryUtil.accessor(this._vramAccess,this,t)},_settingsAccess:function(e){if(typeof e=="undefined")return this._packSettings();this._unpackSettings(e)},_scrollAccess:function(e,t){if(typeof t=="undefined")return this._engine.environment.gpuScrolls[e];this._engine.environment.gpuScrolls[e]=t},_windowPositionAccess:function(e,t){if(typeof t=="undefined")return this._engine.environment.gpuWindowPosition[e];this._engine.environment.gpuWindowPosition[e]=t},_lcdStatusAccess:function(e){if(typeof e=="undefined")return this._packLcdStatus();this._engine.environment.gpuInterrupts=e&120},_lineAccess:function(t,n){if(typeof t!="undefined")throw new Error("Invalid write at "+e.FormatUtil.address(n,16));return this._engine.environment.gpuLine},_lycAccess:function(e){if(typeof e=="undefined")return this._engine.environment.gpuLyCompare;this._engine.environment.gpuLyCompare=e},_oamDmaAccess:function(t,n){if(typeof t=="undefined")throw new Error("Invalid read at "+e.FormatUtil.address(n,16));var r=t<<8;for(var i=0;i<160;++i)this._engine.environment.oam[i]=this._engine.mmu.readUint8(r+i),this._updateSprite(i)},_paletteAccess:function(e,t){if(typeof t=="undefined")return this._packPalette(e);this._unpackPalette(e,t)},_oamAccess:function(e,t,n){if(typeof t=="undefined")return this._engine.environment.oam[e];if(!this._engine.environment.gpuLCDFeature||this._engine.environment.gpuMode===0||this._engine.environment.gpuMode===1)this._engine.environment.oam[e]=t,this._updateSprite(e)},_vramAccess:function(e,t){if(typeof t=="undefined")return this._engine.environment.vram[e];if(!this._engine.environment.gpuLCDFeature||this._engine.environment.gpuMode!==3)this._engine.environment.vram[e]=t,this._updateTile(e)},_packSettings:function(){return(this._engine.environment.gpuBackgroundFeature?1:0)|(this._engine.environment.gpuSpriteFeature?2:0)|(this._engine.environment.gpuSpriteSize?4:0)|(this._engine.environment.gpuBackgroundBase?8:0)|(this._engine.environment.gpuTilesetBase?16:0)|(this._engine.environment.gpuWindowFeature?32:0)|(this._engine.environment.gpuWindowBase?64:0)|(this._engine.environment.gpuLCDFeature?128:0)},_unpackSettings:function(e){this._engine.environment.gpuBackgroundFeature=(e&1)!==0,this._engine.environment.gpuSpriteFeature=(e&2)!==0,this._engine.environment.gpuSpriteSize=(e&4)!==0,this._engine.environment.gpuBackgroundBase=(e&8)!==0,this._engine.environment.gpuTilesetBase=(e&16)!==0,this._engine.environment.gpuWindowFeature=(e&32)!==0,this._engine.environment.gpuWindowBase=(e&64)!==0,this._engine.environment.gpuLCDFeature=(e&128)!==0},_packLcdStatus:function(){return this._engine.environment.gpuMode<<0|this._engine.environment.gpuCoincidence<<2|this._engine.environment.gpuInterrupts<<3},_packPalette:function(e,t){var n=this._engine.environment.palettes[e];return n[0]<<0|n[1]<<2|n[2]<<4|n[3]<<6},_unpackPalette:function(e,t){var n=this._engine.environment.palettes[e];n[0]=t>>0&3,n[1]=t>>2&3,n[2]=t>>4&3,n[3]=t>>6&3},_updateTile:function(e){var t=e&65534,n=t>>4,r=t>>1&7;for(var i=0;i<8;++i){var s=1<<7-i;this._engine.environment.tilesets[n][r][i]=(this._engine.environment.vram[t+0]&s?1:0)|(this._engine.environment.vram[t+1]&s?2:0)}},_updateSprite:function(e){var t=this._sprites[e>>2],n=this._engine.environment.oam[e];switch(e&3){case 0:t.y=n-16;break;case 1:t.x=n-8;break;case 2:t.tile=n;break;case 3:t.palette=n&16?1:0,t.xflip=n&32?!0:!1,t.yflip=n&64?!0:!1,t.priority=n&128?1:0}},_hblank:function(e){for(var t=0,n=this._scanline.length;t<n;++t)this._scanline[t]=255;this._engine.environment.gpuLCDFeature&&this._engine.environment.gpuBackgroundFeature&&this._backgroundScanline(this._scanline,e),this._engine.environment.gpuLCDFeature&&this._engine.environment.gpuWindowFeature&&this._windowScanline(this._scanline,e),this._engine.environment.gpuLCDFeature&&this._engine.environment.gpuSpriteFeature&&this._spritesScanline(this._scanline,e);for(var t=0,r=e,n=this._scanline.length;t<n;++t){var i=this._scanline[t]&255;this._engine._options.devices.screen.setPixel(t,r,i,i,i)}},_vblank:function(){this._engine.environment.pendingInterrupts|=1,this._engine._disableFlush||this._engine._options.devices.screen.flushScreen(),this._engine._continue=!1},_backgroundScanline:function(e,t){var n=this._engine.environment.gpuBackgroundBase?7168:6144,r=this._engine.environment.gpuScrolls[0],i=this._engine.environment.gpuScrolls[1];this._backgroundScanliner(e,n,0,t,r,i)},_spritesScanline:function(e,t){var r=this._engine.environment.gpuSpriteSize?16:8;for(var i=0;i<40;++i){var s=this._sprites[i];if(s.y+r<=t||s.y>t)continue;var o=this._engine.environment.palettes[1+s.palette],u=s.tile;if(this._engine.environment.gpuSpriteSize){var a=t-s.y>=8;s.yflip&&(a=!a),u=a?u|1:u&254}var f=t-s.y&7,l=s.yflip?this._engine.environment.tilesets[u][7-f]:this._engine.environment.tilesets[u][0+f];for(var c=0;c<8;++c){var h=s.x+c;if(h<0||h>=160)continue;var p=s.xflip?7-c:c,d=l[p],v=n[o[d]];if(l[p]===0)continue;if(e[h]&65280&&s.priority)continue;e[h]=d<<8|v}}},_windowScanline:function(e,t){var n=this._engine.environment.gpuWindowBase?7168:6144,r=this._engine.environment.gpuWindowPosition[0]-7,i=this._engine.environment.gpuWindowPosition[1];if(i>t||i+144<=t)return;this._backgroundScanliner(e,n,r,t-i,0,0)},_backgroundScanliner:function(e,t,r,i,s,o){var u=this._engine.environment.gpuTilesetBase?0:256,a=o+i&255,f=a>>3<<5,l=a&7,c=this._engine.environment.palettes[0];for(var h=0;h<160;++h){var p=s+r+h&255,d=p>>3&31,v=p&7,m=t+f+d,g=this._engine.environment.vram[m];this._engine.environment.gpuTilesetBase||g>127&&(g-=256);var y=this._engine.environment.tilesets[u+g][l][v],b=n[c[y]];e[h]=y<<8|b}}})}),n("../../libraries/architectures/gb/./sources/components/IO",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e,this._keys={},this._engine._options.devices.input.on("keydown",function(e){if(!(this._keys[e&240]&(e&15)))return;this._keys[e&240]&=e^15,e&this._engine.environment.ioKeyColumn&&(this._engine.environment.pendingInterrupts[1]|=16)}.bind(this)),this._engine._options.devices.input.on("keyup",function(e){this._keys[e&240]|=e&15}.bind(this))},setup:function(){this._keys[16]=15,this._keys[32]=15},keyMapping:function(t){return t===0?e.MemoryUtil.accessor(this._keyAccess,this):e.MemoryUtil.unadressable(16)},_keyAccess:function(e){if(typeof e=="undefined"){var t=this._engine.environment.ioKeyColumn|15;return this._engine.environment.ioKeyColumn&16&&(t&=this._keys[16]),this._engine.environment.ioKeyColumn&32&&(t&=this._keys[32]),t}this._engine.environment.ioKeyColumn=e&48}})}),n("../../libraries/architectures/gb/./sources/components/../bios",[],function(){return[49,254,255,175,33,255,159,50,203,124,32,251,33,38,255,14,17,62,128,50,226,12,62,243,226,50,62,119,119,62,252,224,71,17,4,1,33,16,128,26,205,149,0,205,150,0,19,123,254,52,32,243,17,216,0,6,8,26,19,34,35,5,32,249,62,25,234,16,153,33,47,153,14,12,61,40,8,50,13,32,249,46,15,24,243,103,62,100,87,224,66,62,145,224,64,4,30,2,14,12,240,68,254,144,32,250,13,32,247,29,32,242,14,19,36,124,30,131,254,98,40,6,30,193,254,100,32,6,123,226,12,62,135,242,240,66,144,224,66,21,32,210,5,32,79,22,32,24,203,79,6,4,197,203,17,23,193,203,17,23,5,32,245,34,35,34,35,201,206,237,102,102,204,13,0,11,3,115,0,131,0,12,0,13,0,8,17,31,136,137,0,14,220,204,110,230,221,221,217,153,187,187,103,99,110,14,236,204,221,220,153,159,187,185,51,62,60,66,185,165,185,165,66,76,33,4,1,17,168,0,26,19,190,32,254,35,125,254,52,32,245,6,25,120,134,35,5,32,251,134,32,254,62,1,224,80]}),n("../../libraries/architectures/gb/./sources/components/MMU",["virtjs","../bios"],function(e,t){return e.ClassUtil.extend([e.EmitterMixin],{initialize:function(t){this._engine=t,e.DebugUtil.preprocessFunction(this,"readUint8",this._engine._options),e.DebugUtil.preprocessFunction(this,"writeUint8",this._engine._options),this._memoryDescriptors=new Array(65536),this._memoryAccessors=new Array(65536)},setup:function(){for(var e=0;e<=65535;++e){var t=this.mapAddress(e);Array.isArray(t)?this._memoryDescriptors[e]=t:this._memoryAccessors[e]=t}},readInt8:function(e){var t=this.readUint8(e);return t>127&&(t-=256),t},readUint8:function(e){var t,n=this._memoryDescriptors[e];n?t=n[0][n[1]]:t=this._memoryAccessors[e](void 0,e);if(typeof preprocess!="undefined"&&(preprocess.events||[]).indexOf("read")!==-1){var r=function(e){t=e};this.emit("read",{address:e,value:t,override:r})}return t},writeUint8:function(e,t){if(typeof preprocess!="undefined"&&(preprocess.events||[]).indexOf("write")!==-1){var n=function(e){t=e};this.emit("write",{address:e,value:t,override:n});if(typeof t=="undefined")return}var r=this._memoryDescriptors[e];r?r[0][r[1]]=t:this._memoryAccessors[e](t,e),typeof preprocess!="undefined"&&(preprocess.events||[]).indexOf("post-write")!==-1&&this.emit("post-write",{address:e,value:t})},readUint16:function(e){var t=this.readUint8(e+0),n=this.readUint8(e+1);return n<<8|t<<0},writeUint16:function(e,t){this.writeUint8(e+0,(t&255)>>0),this.writeUint8(e+1,(t&65280)>>8)},mapAddress:function(t){return t===65535?e.MemoryUtil.plainOldData(this._engine.environment,"enabledInterrupts"):t>=65408&&t<65535?e.MemoryUtil.plainOldData(this._engine.environment.hram,t-65408):!this._engine.environment.mmuBiosLocked&&t===65360?e.MemoryUtil.accessor(this._biosLockAccess,this):t>=65392&&t<65408?e.MemoryUtil.immutable(0):t>=65344&&t<65392?this._engine.gpu.settingsMapping(t-65344):t>=65296&&t<65344?e.MemoryUtil.immutable(0):t===65295?e.MemoryUtil.plainOldData(this._engine.environment,"pendingInterrupts"):t>=65284&&t<65288?this._engine.timer.timerMapping(t-65284):t>=65281&&t<=65282?e.MemoryUtil.immutable(0):t===65280?this._engine.io.keyMapping(t-65280):t>=65184&&t<65280?e.MemoryUtil.immutable(0):t>=65024&&t<65184?this._engine.gpu.oamMapping(t-65024):t>=57344&&t<65024?e.MemoryUtil.plainOldData(this._engine.environment.wram,t&8191):t>=49152&&t<57344?e.MemoryUtil.plainOldData(this._engine.environment.wram,t&8191):t>=40960&&t<49152?this._engine.cartridge.ramMapping(t-40960):t>=32768&&t<40960?this._engine.gpu.vramMapping(t&8191):!this._engine.environment.mmuBiosLocked&&t<256?e.MemoryUtil.accessor(this._biosAccess,this,t):t<32768?this._engine.cartridge.romMapping(t):e.MemoryUtil.unaddressable(t,16)},_biosLockAccess:function(e){if(typeof e=="undefined")return 0;this._engine.environment.mmuBiosLocked=e!==0},_biosAccess:function(e,n){return typeof n=="undefined"?t[e]:void 0}})}),n("../../libraries/architectures/gb/./sources/components/Timer",["virtjs"],function(e){var t={0:1024,1:16,2:64,3:256};return e.ClassUtil.extend({initialize:function(e){this._engine=e},setup:function(){this._buffers=[0,0,0],this._clocks=new Uint8Array(4),this._counterLimits=new Uint8Array(2),this._flags=new Uint8Array(1)},step:function(e){this._buffers[0]+=e*4;while(this._buffers[0]>=256)this._buffers[0]-=256,this._clocks[0]+=1;if(!this._enableTimer)return;this._buffers[1]+=e*4;var n=t[this._counterLimits[1]];while(this._buffers[1]>=n)this._buffers[1]-=n,this._clocks[1]+=1,this._clocks[1]===0&&(this._clocks[1]=this._counterLimits[0],this._engine.environment.pendingInterrupts|=4)},oldStep:function(e){this._buffers[0]+=e,this._buffers[0]>=4&&(this._buffers[0]-=4,this._buffers[1]+=1,this._buffers[1]===16&&(this._clocks[0]+=1,this._buffers[1]=0),this._enableTimer&&(this._buffers[2]+=1),this._buffers[2]===this._counterLimits[1]&&(this._clocks[1]+=1,this._buffers[2]=0,this._clocks[1]===0&&(this._clocks[1]=this._counterLimits[0],this._engine.environment.pendingInterrupts|=4)))},timerMapping:function(t){return t===0?e.MemoryUtil.accessor(this._dividerAccess,this):t===1?e.MemoryUtil.plainOldData(this._clocks,1):t===2?e.MemoryUtil.plainOldData(this._counterLimits,0):t===3?e.MemoryUtil.accessor(this._controlAccess,this):e.MemoryUtil.unadressable(t,16)},_dividerAccess:function(e){if(typeof e=="undefined")return this._clocks[0];this._clocks[0]=0},_controlAccess:function(e){if(typeof e=="undefined")return this._packFlags();this._unpackFlags(e)},_packFlags:function(){return(this._enableTimer?4:0)|this._counterLimits[1]},_unpackFlags:function(e){this._enableTimer=!!(e&4),this._counterLimits[1]=e&3}})}),n("../../libraries/architectures/gb/./sources/tables/../components/mbc/MBC1",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e},setup:function(){this._engine.environment.mbc1Mode=0,this._engine.environment.mbc1RamFeature=!1,this._engine.environment.mbc1Ram=new Uint8Array(24576),this._engine.environment.mbc1RomBank=1,this._engine.environment.mbc1RamBank=0,this._romBanks=[];for(var e=0;e*16384<this._engine.environment.rom.buffer.byteLength;++e)this._romBanks[e]=new Uint8Array(this._engine.environment.rom.buffer,e*16384,16384);this._ramBanks=[];for(var t=0;t*8192<this._engine.environment.mbc1Ram.buffer.byteLength;++t)this._ramBanks[t]=new Uint8Array(this._engine.environment.mbc1Ram.buffer,t*8192,8192);this._romBank00=this._romBanks[0],this._romBankNN=null,this._ramBankNN=null,this._rebank()},romMapping:function(t){return t<16384?e.MemoryUtil.accessor(this._romBank00Access,this,t):e.MemoryUtil.accessor(this._romBankNNAccess,this,t-16384)},ramMapping:function(t){return e.MemoryUtil.accessor(this._ramBankNNAccess,this,t)},_rebank:function(){var e=this._engine.environment.mbc1RomBank,t=this._engine.environment.mbc1RamBank;this._engine.environment.mbc1Mode===0?t=0:e&=31,(e&31)===0&&(e+=1),this._romBankNN=this._romBanks[e],this._ramBankNN=this._ramBanks[t]},_romBank00Access:function(e,t){return typeof t=="undefined"?this._romBank00[e]:(e<8192?this._engine.environment.mbc1RamFeature=(t&10)===10:(this._engine.environment.mbc1RomBank&=96,this._engine.environment.mbc1RomBank|=(t&31)<<0,this._rebank()),undefined)},_romBankNNAccess:function(e,t){return typeof t=="undefined"?this._romBankNN[e]:(e<8192?(this._engine.environment.mbc1RomBank&=31,this._engine.environment.mbc1RomBank|=(t&3)<<5,this._engine.environment.mbc1RamBank=t&3,this._rebank()):(this._engine.environment.mbc1Mode=t&1,this._rebank()),undefined)},_ramBankNNAccess:function(e,t){return typeof t=="undefined"?this._engine.environment.mbc1RamFeature?this._ramBankNN[e]:0:(this._engine.environment.mbc1RamFeature&&(this._ramBankNN[e]=t),undefined)}})}),n("../../libraries/architectures/gb/./sources/tables/../components/mbc/MBC3",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e,this._engine._options.data.on("requestSave",function(){if(!this._storageName)return;this._engine._options.data.save(this._storageName,{ram:this._engine.environment.mbc3Ram.buffer})}.bind(this))},setup:function(){this._storageName=this._engine.environment.ident?this._engine.environment.ident+".":"",this._storageName+="cartridge";var e=this._engine._options.data.restore(this._storageName)||{};this._engine.environment.mbc3Mode=0,this._engine.environment.mbc3RamFeature=!1,this._engine.environment.mbc3Ram=new Uint8Array(e.ram||new ArrayBuffer(32768)),this._engine.environment.mbc3Rtc=new Uint8Array(5),this._engine.environment.mbc3Latch=new Uint8Array(1),this._engine.environment.mbc3RomBank=1,this._engine.environment.mbc3RamBank=0,this._romBanks=[];for(var t=0;t*16384<this._engine.environment.rom.buffer.byteLength;++t)this._romBanks[t]=new Uint8Array(this._engine.environment.rom.buffer,t*16384,16384);this._ramBanks=[];for(var n=0;n*8192<this._engine.environment.mbc3Ram.buffer.byteLength;++n)this._ramBanks[n]=new Uint8Array(this._engine.environment.mbc3Ram.buffer,n*8192,8192);this._romBank00=this._romBanks[0],this._romBankNN=null,this._ramBankNN=null,this._rebank()},romMapping:function(t){return t<16384?e.MemoryUtil.accessor(this._romBank00Access,this,t):e.MemoryUtil.accessor(this._romBankNNAccess,this,t-16384)},ramMapping:function(t){return e.MemoryUtil.accessor(this._ramBankNNAccess,this,t)},_rebank:function(){var e=this._engine.environment.mbc3RomBank,t=this._engine.environment.mbc3RamBank;this._romBankNN=this._romBanks[e],this._ramBankNN=this._ramBanks[t]},_latch:function(){var e=new Date,t=this._engine.environment.mbc3Rtc;t[0]=e.getSeconds(),t[1]=e.getMinutes(),t[2]=e.getHours(),t[3]=0,t[4]=0},_romBank00Access:function(e,t){return typeof t=="undefined"?this._romBank00[e]:(e<8192?this._engine.environment.mbc3RamFeature=(t&10)===10:(this._engine.environment.mbc3RomBank=t&127,this._engine.environment.mbc3RomBank===0&&(this._engine.environment.mbc3RomBank+=1),this._rebank()),undefined)},_romBankNNAccess:function(e,t){if(typeof t=="undefined")return this._romBankNN[e];if(e<8192)this._engine.environment.mbc3RamFeature=t<=3,this._engine.environment.mbc3RamFeature?(this._engine.environment.mbc3RamBank=t&3,this._engine.environment.mbc3RtcIndex=0):(this._engine.environment.mbc3RtcIndex=t-8,this._engine.environment.mbc3RamBank=0),this._rebank();else{var n=this._engine.environment.mbc3Latch[0]===0;this._engine.environment.mbc3Latch[0]=t;var r=n&&this._engine.environment.mbc3Latch[0]===1;r&&this._latch()}return undefined},_ramBankNNAccess:function(e,t){return typeof t=="undefined"?this._engine.environment.mbc3RamFeature?this._ramBankNN[e]:this._engine.environment.mbc3Rtc[this._engine.environment.mbc3RtcIndex]:(this._engine.environment.mbc3RamFeature?this._ramBankNN[e]=t:this._engine.environment.mbc3Rtc[this._engine.environment.mbc3RtcIndex]=t,undefined)}})}),n("../../libraries/architectures/gb/./sources/tables/../components/mbc/MBC5",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e},setup:function(){this._engine.environment.mbc5Mode=0,this._engine.environment.mbc5RamFeature=!1,this._engine.environment.mbc5Ram=new Uint8Array(122880),this._engine.environment.mbc5RomBank=1,this._engine.environment.mbc5RamBank=0,this._romBanks=[];for(var e=0;e*16384<this._engine.environment.rom.buffer.byteLength;++e)this._romBanks[e]=new Uint8Array(this._engine.environment.rom.buffer,e*16384,16384);this._ramBanks=[];for(var t=0;t*8192<this._engine.environment.mbc5Ram.buffer.byteLength;++t)this._ramBanks[t]=new Uint8Array(this._engine.environment.mbc5Ram.buffer,t*8192,8192);this._romBank00=this._romBanks[0],this._romBankNN=null,this._ramBankNN=null,this._rebank()},romMapping:function(t){return t<16384?e.MemoryUtil.accessor(this._romBank00Access,this,t):e.MemoryUtil.accessor(this._romBankNNAccess,this,t-16384)},ramMapping:function(t){return e.MemoryUtil.accessor(this._ramBankNNAccess,this,t)},_rebank:function(){var e=this._engine.environment.mbc5RomBank,t=this._engine.environment.mbc5RamBank;this._romBankNN!==this._romBanks[e]&&console.log("# ROM bank switched to "+e),this._romBankNN=this._romBanks[e],this._ramBankNN=this._ramBanks[t]},_romBank00Access:function(e,t){return typeof t=="undefined"?this._romBank00[e]:(e<8192?this._engine.environment.mbc5RamFeature=(t&10)===10:(e<12288?(this._engine.environment.mbc5RomBank&=256,this._engine.environment.mbc5RomBank|=t):(this._engine.environment.mbc5RomBank&=255,this._engine.environment.mbc5RomBank|=(t&1)<<8),this._rebank()),undefined)},_romBankNNAccess:function(e,t){if(typeof t=="undefined")return this._romBankNN[e];this._engine.environment.mbc5RamBank=t&15,this._rebank()},_ramBankNNAccess:function(e,t){return typeof t=="undefined"?this._engine.environment.mbc5RamFeature?this._ramBankNN[e]:0:(this._engine.environment.mbc5RamFeature&&(this._ramBankNN[e]=t),undefined)}})}),n("../../libraries/architectures/gb/./sources/tables/../components/mbc/NoMBC",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e){this._engine=e},setup:function(){this._engine.environment.nombcRomBank=new Uint8Array(32768),this._engine.environment.nombcRamBank=new Uint8Array(8192);var e=this._engine.environment.rom;for(var t=0,n=e.length;t<n;++t)this._engine.environment.nombcRomBank[t]=e[t]},romMapping:function(t){return e.MemoryUtil.accessor(this._romAccess,this,t)},ramMapping:function(t){return e.MemoryUtil.plainOldData(this._engine.environment.nombcRamBank,t)},_romAccess:function(e,t){return typeof t=="undefined"?this._engine.environment.nombcRomBank[e]:void 0}})}),n("../../libraries/architectures/gb/./sources/tables/mbcTypes",["../components/mbc/MBC1","../components/mbc/MBC3","../components/mbc/MBC5","../components/mbc/NoMBC"],function(e,t,n,r){return{0:r,1:e,2:e,3:e,15:t,16:t,17:t,18:t,19:t,25:n,26:n,27:n,28:n,29:n,30:n}}),n("../../libraries/architectures/gb/./sources/Environment",["virtjs"],function(e){return e.ClassUtil.extend({initialize:function(e,t){this.rom=new Uint8Array(e),this.ident=t.ident,this.pc=new Uint16Array([0]),this.sp=new Uint16Array([65534]),this.af={},this.a=new Uint8Array(1),this.f={},this.bc=new Uint16Array(1),this.b=new Uint8Array(this.bc.buffer,1,1),this.c=new Uint8Array(this.bc.buffer,0,1),this.de=new Uint16Array(1),this.d=new Uint8Array(this.de.buffer,1,1),this.e=new Uint8Array(this.de.buffer,0,1),this.hl=new Uint16Array(1),this.h=new Uint8Array(this.hl.buffer,1,1),this.l=new Uint8Array(this.hl.buffer,0,1),this.mmuBiosLocked=!1,this.gpuBackgroundFeature=!0,this.gpuSpriteFeature=!1,this.gpuLCDFeature=!0,this.gpuCoincidence=!1,this.gpuMode=2,this.gpuInterrupts=0,this.gpuLyCompare=0,this.gpuSpriteSize=0,this.gpuTilesetBase=1,this.gpuBackgroundBase=0,this.gpuScrolls=new Uint8Array(2),this.gpuWindowFeature=!1,this.gpuWindowBase=0,this.gpuWindowPosition=new Uint8Array(2),this.gpuClock=0,this.gpuFrameClock=0,this.gpuLine=0,this.cpuInterruptFeature=!1,this.cpuZero=!1,this.cpuHalf=!1,this.cpuCarry=!1,this.cpuBCD=!1,this.cpuMode=2,this.ioKeyColumn=0,this.enabledInterrupts=0,this.pendingInterrupts=0,this.wram=new Uint8Array(8192),this.hram=new Uint8Array(127),this.oam=new Uint8Array(175),this.vram=new Uint8Array(8192),this.nombcRomBank=null,this.nombcRamBank=null,this.mbc1Mode=null,this.mbc1RamFeature=!1,this.mbc1Ram=null,this.mbc1RomBank=1,this.mbc1RamBank=0,this.mbc3Mode=null,this.mbc3RamFeature=!1,this.mbc3Ram=null,this.mbc3Rtc=null,this.mbc3Latch=null,this.mbc3RomBank=1,this.mbc3RamBank=0,this.palettes=[];for(var n=0;n<4;++n)this.palettes[n]=new Uint8Array(4);this.tilesets=[];for(var n=0;n<1024;++n){this.tilesets[n]=[];for(var r=0;r<8;++r)this.tilesets[n][r]=new Uint8Array(8)}["af","a","f","bc","b","c","de","d","e","hl","h","l"].forEach(function(e){this[e].xRegister=e}.bind(this)),Object.defineProperty(this.af,"0",{get:function(){return this.a[0]<<8|this.f[0]<<0}.bind(this),set:function(e){this.a[0]=(e&65280)>>8,this.f[0]=(e&255)>>0}.bind(this)}),Object.defineProperty(this.f,"0",{get:function(){return(this.cpuBCD?64:0)|(this.cpuZero?128:0)|(this.cpuHalf?32:0)|(this.cpuCarry?16:0)}.bind(this),set:function(e){this.cpuBCD=(e&64)!==0,this.cpuZero=(e&128)!==0,this.cpuHalf=(e&32)!==0,this.cpuCarry=(e&16)!==0}.bind(this)})}})}),n("../../libraries/architectures/gb/index",["virtjs","./sources/components/CPU","./sources/components/GPU","./sources/components/IO","./sources/components/MMU","./sources/components/Timer","./sources/tables/mbcTypes","./sources/Environment"],function(e,t,n,r,i,s,o,u){return e.engine.GameBoy=e.Engine.extend([e.EmitterMixin],{initialize:function(){e.Engine.prototype.initialize.apply(this,arguments),this._options.devices.screen.setInputSize(160,144),this.environment=null,this.cpu=new t(this),this.gpu=new n(this),this.io=new r(this),this.mmu=new i(this),this.timer=new s(this),e.DebugUtil.preprocessFunction(this,"_load",this._options),e.DebugUtil.preprocessFunction(this,"step",this._options),e.DebugUtil.preprocessFunction(this,"setIterationCountPerFrame",this._options),e.DebugUtil.preprocessFunction(this,"setMaxSubIterations",this._options),e.DebugUtil.preprocessFunction(this,"_setupEnvironment",this._options)},_load:function(e,t){t=t||{},this.environment=this._createEnvironment(e,t),this.cartridge=this._createRomMBC(this.environment),this.cpu.setup(),this.gpu.setup(),this.io.setup(),this.timer.setup(),this.cartridge.setup(),this.mmu.setup(),typeof preprocess!="undefined"&&(preprocess.events||[]).indexOf("load")!==-1&&this.emit("load")},step:function(){if(typeof preprocess!="undefined"&&typeof preprocess.maxSubIterations!="undefined"){this._continue=!0;for(var e=0;this._status==="running"&&this._continue&&e<this._options.maxSubIterations;++e)this.cpu.step()}else if(typeof preprocess!="undefined"&&typeof preprocess.iterationCountPerFrame!="undefined"){this._disableFlush=!0;for(var e=0,t=this._options.iterationCountPerFrame;e<t&&this._status==="running";++e){this._continue=!0;while(this._status==="running"&&this._continue)this.cpu.step()}this._options.devices.screen.flushScreen()}else{this._continue=!0;while(this._status==="running"&&this._continue)this.cpu.step()}},disassembleAt:function(e){try{var t=this.mmu.readUint8(e),n=this.cpu._opcodeMaps.unprefixed[t]}catch(r){var i={size:1,label:"<corrupted : cannot fetch opcode>"}}if(!i)try{var i=n?n.xDefinition.debug.call(this._cpu,e+1):{size:1,label:"<corrupted : null instruction>"}}catch(r){var i={size:1,label:"<corrupted : "+r.message+">"}}i.address=e,i.opcode=[];for(var s=0;s<i.size;++s)i.opcode.push(this.byteAt(e+s));return i},byteAt:function(e){try{return this.mmu.readUint8(e)}catch(t){return NaN}},setMaxSubIterations:function(e){if(typeof preprocess!="undefined"&&typeof preprocess.maxSubIterations=="undefined")throw new Error("Cannot change the sub iteration limit of this engine - please set maxSubIterations to non-nil at creation");this._options.maxSubIterations=e},setIterationCountPerFrame:function(e){if(typeof preprocess!="undefined"&&typeof preprocess.iterationCountPerFrame=="undefined")throw new Error("Cannot change the iteration count per frame of this engine - please set iterationCountPerFrame to non-nil at creation");this._options.iterationCountPerFrame=e},_createRomMBC:function(t){var n=t.rom[327];if(!o[n])throw new Error("Unexpected MBC type ("+e.FormatUtil.hexadecimal(n,8)+")");return new o[n](this)},_createEnvironment:function(e,t){return t&&t.environment?t.environment:this._setupEnvironment(new u(e,t||{}))},_setupEnvironment:function(e){return typeof preprocess=="undefined"||!preprocess.skipBios?e:(e.a[0]=1,e.f[0]=176,e.b[0]=0,e.c[0]=19,e.d[0]=0,e.e[0]=216,e.h[0]=1,e.l[0]=77,e.pc[0]=256,e.sp[0]=65534,e.mmuBiosLocked=!0,e)}},{RIGHT:33,LEFT:34,UP:36,DOWN:40,A:17,B:18,SELECT:20,START:24})}),t(["../../libraries/architectures/gb/index"])});